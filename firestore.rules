// Firestore Rules (dev-safe; tighten later)
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Join codes published by the host:
    // Allow anonymous GET if the code is active.
    match /codes/{codeId} {
      allow get: if resource.data.active == true;
    }

    // Session + signaling docs (open for development)
    match /sessions/{sessionId} {
      allow get, list, create, update: if true;

      match /offers/{doc} {
        allow read, write: if true;
      }
      match /answers/{doc} {
        allow read, write: if true;
      }
      match /candidates_host/{doc} {
        allow read, write: if true;
      }
      match /candidates_viewer/{doc} {
        allow read, write: if true;
      }
    }
  }
}
